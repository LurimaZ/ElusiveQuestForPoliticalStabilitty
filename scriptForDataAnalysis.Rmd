---
title: "Quantitative Data Analysis"
author: "Adrien Ratsimbaharison"
date: "9/29/2018"
output:
  word_document: 
    fig_caption: yes
    toc: yes
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Descriptive statistics on political stability around the world:

```{r message=FALSE, warning=FALSE, include=FALSE}


library(readr)
library(lubridate)
library(dplyr)
library(Hmisc)
library(caret)
library(kernlab)
library(stringr)
library(knitr)
library(VIM)

# reading the data in r
WGIbyCountryAndRegion <- read.csv("WGIbyCountryAndRegion.csv")
WGIbyCountryAndRegion <- tbl_df(WGIbyCountryAndRegion)
WGIbyCountryAndRegion$date <- as.numeric(WGIbyCountryAndRegion$date)
glimpse(WGIbyCountryAndRegion)

```

### Political Stability Average and Trend for the Period of 1996-2017

#### Political stability average

The summary statistics of political stability shows that the world has been slightly unstable during the period of 1996 to 2016, but for the majority of the observations have been been stable:

- mean = -0.03591
- median = 0.06886

However, whle the maximum value of stability was only 1.96, the minimum value was -3.31

The boxplot and histogram of political stability also demonstrate that the majority of the observations were positive, but there were some extreme values of instability (the histogram is skewed to the left).


```{r echo=TRUE, message=FALSE, warning=FALSE}

# The summary statistics of political stability estimate around the world

summary(WGIbyCountryAndRegion$stability)


```


```{r echo=TRUE, message=FALSE, warning=FALSE, fig.cap="The Political Stability Average of the World (1996-2016)"}
boxplot(WGIbyCountryAndRegion$stability, ylab = "Political Stability")
abline(h = 0, lwd= 1.5)

```

```{r echo=TRUE, message=FALSE, warning=FALSE, fig.cap="Frequency of Political Stability of the World (1996-2016)"}

hist(WGIbyCountryAndRegion$stability, main = "", xlab = "Political Stability")
abline(v = median(WGIbyCountryAndRegion$stability, na.rm = TRUE), lwd = 2)
text(x = -1, y = 650, "Median= 0.06886")

```

```{r echo=TRUE, message=FALSE, warning=FALSE}

#Proportion of stability and instability for the whole world

stabilityProp <- table(WGIbyCountryAndRegion$stabilityDummy)
stabilityProp
prop.table(stabilityProp)

```


#### Political stability by categories:



```{r echo=TRUE, message=FALSE, warning=FALSE}

stabilityByCat <- table(WGIbyCountryAndRegion$stabilityCategory)
stabilityByCat
prop.table(stabilityByCat)

```


#### Political stability trend

When looking at the trend of political stability around the world for the period of 1996-2016, the table on the annual average of political stability was hovering around zero, although it has slightly delined in recent years.

```{r echo=TRUE, message=FALSE, warning=FALSE}

# generating a table of political stability trend of the world for the period of 1996-2016

stabilityTrend <- WGIbyCountryAndRegion %>%
  group_by(date) %>%
  summarise(stabilityAnnualAverage = mean(stability, na.rm=TRUE))
stabilityTrend

```

```{r echo=FALSE, fig.height=5, fig.width=5, message=FALSE, warning=FALSE, fig.cap= "Trend of the Political Stability of the World for the Period of 1996-2016"}

# plotting the stability trend of the world

plot(stabilityTrend$date, stabilityTrend$stabilityAnnualAverage, type="o", lwd = 2,
     ylim=range( -0.5,0.5),
     xlab = "Years", ylab = "Political Stability")
abline(h = 0, lwd = 1.5)


```



### Political Stability by Region


- Political stability average by region



```{r echo= FALSE}
#Proportion of stability by region

stabilityPropByRegion <- table(WGIbyCountryAndRegion$stabilityDummy, WGIbyCountryAndRegion$region)
stabilityPropByRegion
prop.table(stabilityPropByRegion)


```


```{r echo=TRUE, message=FALSE, warning=FALSE}

# generating political stability average for each region of the world for the period of 1996-2016

WGIbyCountryAndRegion %>%
    group_by(region) %>%
    summarise_each(funs(mean), stability)

```



```{r echo=TRUE, fig.cap=, message=FALSE, warning=FALSE, fig.cap="Political Stability of the Different Regions of the World", fig.height= 4, fig.width= 5.5}

# Boxplot of Political Stability by Region
boxplot(stability~region,data=WGIbyCountryAndRegion, main="",
        xlab="Regions", ylab="Political Stability")
abline(h = 0, lwd = 2)

```


#### Political stability trends by region




```{r echo=TRUE, message=FALSE, warning=FALSE}

# generating a table of political stability trend of the world for the period of 1996-2016

stabilityTrend <- WGIbyCountryAndRegion %>%
  group_by(date) %>%
  summarise(stabilityAnnualAverage = mean(stability, na.rm=TRUE))
stabilityTrend

```

```{r echo=FALSE}
# stability trend for Africa
africaDF <- filter(WGIbyCountryAndRegion, region == "Africa")
stabilityTrendAf <- africaDF %>%
  group_by(date) %>% 
  summarise(stabilityAnnualAverage = mean(stability, na.rm=TRUE))
head(stabilityTrendAf)
```


```{r echo=TRUE, message=FALSE, warning=FALSE}
# plotting the stability trend in Africa
plot(stabilityTrendAf$date, stabilityTrendAf$stabilityAnnualAverage, type="o", lwd = 2,
     ylim=range(-1, 1),
     main="Fig. 1.3 - Trend of the Political Stability in Africa for the Period of 1996-2016",
     xlab = "Years", ylab = "Political Stability Estimate (Annual Average)")
abline(h = 0, lwd = 1.5)


```


```{r echo=TRUE, message=FALSE, warning=FALSE}
# stability trend for the rest of the world
restOfWorldDF <- filter(WGIbyCountryAndRegion, region != "Africa")
stabilityTrendRoW <- restOfWorldDF %>%
  group_by(date) %>% 
  summarise(stabilityAnnualAverage = mean(stability, na.rm=TRUE))
head(stabilityTrendRoW)
```


```{r echo=TRUE, message=FALSE, warning=FALSE}
# plotting the stability trend for the rest of the world
plot(stabilityTrendRoW$date, stabilityTrendRoW$stabilityAnnualAverage, type="o", lwd = 2,
     ylim=range(-1, 1),
     main="Fig. 1.3 - Trend of the Political Stability for the Rest of the World for the Period of 1996-2016",
     xlab = "Years", ylab = "Political Stability Estimate (Annual Average)")
abline(h = 0, lwd = 1.5)

```



```{r}
# plotting the trend of political stability of the world using ggplot
stabilityAnAv <- WGIbyCountryAndRegion %>%
  group_by(date) %>%
  summarise(stabilityAnnualAverage = mean(stability))
            
ggplot(stabilityAnAv, aes(x = date, y = stabilityAnnualAverage)) +
  geom_line() +
  xlim(1995, 2016) + 
  ylim(-0.5, .5)


```

```{r}
# plotting the trend of political stability by region using ggplot
stabilityTrendByRegion <- WGIbyCountryAndRegion %>%
  group_by(region, date) %>%
  summarise(stabilityTrend = mean(stability))
            
ggplot(stabilityTrendByRegion, aes(x = date, y = stabilityTrend, color = region)) +
  geom_line() +
  geom_hline(yintercept=0) 

```

## Why Political Stability Matters: Simple Correlations Between Political Stability and Other Variables

### Political Stability and Economic Performance

```{r echo=TRUE, message=FALSE, warning=FALSE}

WGIdevIneqPovDF <- read.csv("WGIdevIneqPovDF.csv")
WGIdevIneqPovDF <- tbl_df(WGIdevIneqPovDF)

```

```{r}

# scaterplot of political stability and GDP annual growth average

plot(WGIdevIneqPovDF$stability, WGIdevIneqPovDF$GDPannualGrowthRate)
abline(h = 0, lwd = 1.5)

```


```{r}

# scaterplot of political stability and GDP annual growth average by country using ggplot

gdpGrowth <- WGIdevIneqPovDF %>%
  group_by(country, date) %>%
  summarise(gdpGrowthAverage = mean(GDPannualGrowthRate),
            stabilitAverage = mean(stability))

ggplot(gdpGrowth, aes(x=stabilitAverage, y=gdpGrowthAverage)) +
  geom_point()
```


```{r echo=TRUE, message=FALSE, warning=FALSE}

# scaterplot of political stability and GNI per capita

plot(WGIdevIneqPovDF$stability, WGIdevIneqPovDF$GNIperCapita)


```



```{r echo=TRUE, message=FALSE, warning=FALSE}

# scaterplot of political stability and GNI per capita using ggplot

ggplot(WGIdevIneqPovDF, aes(stability, y = GNIperCapita)) +
  geom_point() +
  geom_smooth()


```


```{r echo=TRUE, message=FALSE, warning=FALSE}

# scaterplot of political stability and HDI

plot(WGIdevIneqPovDF$stability, WGIdevIneqPovDF$HDI)


```


```{r echo=TRUE, message=FALSE, warning=FALSE}

# scaterplot of political stability and HDI using ggplot

ggplot(WGIdevIneqPovDF, aes(stability, y = HDI)) +
  geom_point() +
  geom_smooth()


```
